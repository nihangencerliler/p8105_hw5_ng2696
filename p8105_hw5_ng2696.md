hw5
================
Nihan Gencerliler
11/9/2019

## Problem 1

``` r
set.seed(10)

iris_with_missing = iris %>% 
  map_df(~replace(.x, sample(1:150, 20), NA)) %>%
  mutate(Species = as.character(Species))

replace_missing = function(original_values) {
  if (is.numeric(original_values))
   {new_values=replace_na(original_values, mean(original_values,na.rm = TRUE))}
  else 
  {new_values=replace_na(original_values, "virginica")}
  new_values
}

iris_without_missing = map_dfr(iris_with_missing, replace_missing)

head(iris_without_missing)
```

    ## # A tibble: 6 x 5
    ##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
    ##          <dbl>       <dbl>        <dbl>       <dbl> <chr>  
    ## 1          5.1         3.5          1.4        0.2  setosa 
    ## 2          4.9         3            1.4        0.2  setosa 
    ## 3          4.7         3.2          1.3        0.2  setosa 
    ## 4          4.6         3.1          1.5        1.19 setosa 
    ## 5          5           3.6          1.4        0.2  setosa 
    ## 6          5.4         3.9          1.7        0.4  setosa

For numeric variables, you should fill in missing values with the mean
of non-missing values For character variables, you should fill in
missing values with “virginica”

## Problem 2

This zip file contains data from a longitudinal study that included a
control arm and an experimental arm. Data for each participant is
included in a separate file, and file names include the subject ID and
arm.

Create a tidy dataframe containing data from all participants, including
the subject ID, arm, and observations over time:

subject ID arm observations time Start with a dataframe containing all
file names; the list.files function will help Iterate over file names
and read in data for each subject using purrr::map and saving the result
as a new variable in the dataframe Tidy the result; manipulate file
names to include control arm and subject ID, make sure weekly
observations are “tidy”, and do any other tidying that’s necessary Make
a spaghetti plot showing observations on each subject over time, and
comment on differences between group

``` r
#create vector of filenames
files_vec=list.files(path = "./data", full.names = TRUE) 
#create dataframe of filenames, subjectID, arm
data_frame(filename=files_vec, subject_ID=str_sub(files_vec,-6,-5), arm=str_sub(files_vec,-10,-8)) %>%
  mutate(file_contents = map(filename,read.csv)
  ) %>%
  unnest(file_contents)
```

    ## # A tibble: 20 x 11
    ##    filename subject_ID arm   week_1 week_2 week_3 week_4 week_5 week_6
    ##    <chr>    <chr>      <chr>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>
    ##  1 ./data/… 01         con     0.2  -1.31    0.66   1.96   0.23   1.09
    ##  2 ./data/… 02         con     1.13 -0.88    1.07   0.17  -0.83  -0.31
    ##  3 ./data/… 03         con     1.77  3.11    2.22   3.26   3.31   0.89
    ##  4 ./data/… 04         con     1.04  3.66    1.22   2.33   1.47   2.7 
    ##  5 ./data/… 05         con     0.47 -0.580  -0.09  -1.37  -0.32  -2.17
    ##  6 ./data/… 06         con     2.37  2.5     1.59  -0.16   2.08   3.07
    ##  7 ./data/… 07         con     0.03  1.21    1.13   0.64   0.49  -0.12
    ##  8 ./data/… 08         con    -0.08  1.42    0.09   0.36   1.18  -1.16
    ##  9 ./data/… 09         con     0.08  1.24    1.44   0.41   0.95   2.75
    ## 10 ./data/… 10         con     2.14  1.15    2.52   3.44   4.26   0.97
    ## 11 ./data/… 01         exp     3.05  3.67    4.84   5.8    6.33   5.46
    ## 12 ./data/… 02         exp    -0.84  2.63    1.64   2.58   1.24   2.32
    ## 13 ./data/… 03         exp     2.15  2.08    1.82   2.84   3.36   3.61
    ## 14 ./data/… 04         exp    -0.62  2.54    3.78   2.73   4.49   5.82
    ## 15 ./data/… 05         exp     0.7   3.33    5.34   5.57   6.9    6.66
    ## 16 ./data/… 06         exp     3.73  4.08    5.4    6.41   4.87   6.09
    ## 17 ./data/… 07         exp     1.18  2.35    1.23   1.17   2.02   1.61
    ## 18 ./data/… 08         exp     1.37  1.43    1.84   3.6    3.8    4.72
    ## 19 ./data/… 09         exp    -0.4   1.08    2.66   2.7    2.8    2.64
    ## 20 ./data/… 10         exp     1.09  2.8     2.8    4.3    2.25   6.57
    ## # … with 2 more variables: week_7 <dbl>, week_8 <dbl>
